(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"0zfc":function(e,t,r){"use strict";r.r(t),r.d(t,"UserModul",(function(){return Re}));var s=r("ofXK"),i=r("3Pt+"),a=r("bTqV"),o=r("Wp6s"),c=r("bSwM"),n=r("FKr1"),u=r("0IaG"),b=r("NFeN"),l=r("qFsG"),d=r("QibW"),m=r("d3UM"),p=r("5RNC"),h=r("dNgK"),f=r("tyNb"),v=r("9jGm"),g=r("l7P3"),R=r("NUQi"),Q=r("quSY"),w=r("PEil"),O=r("1YFl"),F=r("rIDv"),j=r("R0sL");const y=Object(j.a)({selectId:e=>e.id}),N=y.getInitialState(),z=Object(g.p)(N,Object(g.r)(F.d,(e,t)=>y.addMany(t.users,e)),Object(g.r)(F.b,(e,t)=>y.removeOne(t.id,e)),Object(g.r)(F.f,(e,t)=>y.addOne(t.user,e)),Object(g.r)(F.i,(e,t)=>{return y.updateOne({id:(r=t.user).id,changes:r},e);var r}),Object(g.r)(F.g,(e,t)=>Object.assign(Object.assign({},e),{selectedUserId:t.id})));function k(e=N,t){return z(e,t)}const A=Object(g.o)("user"),I=Object(g.q)(A,e=>e.ids),U=Object(g.q)(A,e=>e.entities),C=Object(g.q)(I,U,(e,t)=>e.map(e=>t[e]).map(e=>({id:e.id,email:e.email,name:`${e.firstName} ${e.lastName}`}))),q=(Object(g.q)(A,U,(e,t)=>{var r;return null!==(r=t[e.selectedUserId])&&void 0!==r?r:null}),e=>Object(g.q)(U,t=>t[e]));var D=r("fXoL"),M=r("kmnG");function S(e,t){1&e&&(D.Rb(0,"span"),D.zc(1,"New User"),D.Qb())}function E(e,t){1&e&&(D.Rb(0,"span"),D.zc(1,"Edit User"),D.Qb())}function $(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," Email is "),D.Rb(2,"strong"),D.zc(3,"required"),D.Qb(),D.Qb())}function G(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," First name is "),D.Rb(2,"strong"),D.zc(3,"required"),D.Qb(),D.Qb())}function V(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," Surname is "),D.Rb(2,"strong"),D.zc(3,"required"),D.Qb(),D.Qb())}function x(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," Password is "),D.Rb(2,"strong"),D.zc(3,"required"),D.Qb(),D.Qb())}function P(e,t){if(1&e&&(D.Rb(0,"mat-form-field",7),D.Rb(1,"mat-label"),D.zc(2,"Password"),D.Qb(),D.Nb(3,"input",18),D.yc(4,x,4,0,"mat-error",2),D.Qb()),2&e){const e=D.cc();D.Ab(4),D.ic("ngIf",e.userForm.controls.password.hasError("required"))}}function B(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," Verify password is "),D.Rb(2,"strong"),D.zc(3,"required"),D.Qb(),D.Qb())}function Y(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," Verified password "),D.Rb(2,"strong"),D.zc(3,"has to be same"),D.Qb(),D.zc(4," as Password "),D.Qb())}function L(e,t){if(1&e&&(D.Rb(0,"mat-form-field",7),D.Rb(1,"mat-label"),D.zc(2,"Verify password"),D.Qb(),D.Nb(3,"input",19),D.yc(4,B,4,0,"mat-error",2),D.yc(5,Y,5,0,"mat-error",2),D.Qb()),2&e){const e=D.cc();D.Ab(4),D.ic("ngIf",e.userForm.controls.passwordCheck.hasError("required")),D.Ab(1),D.ic("ngIf",e.userForm.controls.passwordCheck.hasError("differentPassword"))}}function _(e,t){if(1&e&&(D.Rb(0,"mat-option",20),D.zc(1),D.Qb()),2&e){const e=t.$implicit;D.ic("value",e.id.toLowerCase()),D.Ab(1),D.Bc(" ",e.text," ")}}function J(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," Restaurant is "),D.Rb(2,"strong"),D.zc(3,"required"),D.Qb(),D.Qb())}function K(e,t){if(1&e&&(D.Rb(0,"mat-option",20),D.zc(1),D.Qb()),2&e){const e=t.$implicit;D.ic("value",e.id),D.Ab(1),D.Bc(" ",e.text," ")}}function W(e,t){1&e&&(D.Rb(0,"mat-error"),D.zc(1," User role is "),D.Rb(2,"strong"),D.zc(3,"required"),D.Qb(),D.Qb())}function X(e,t){if(1&e){const e=D.Sb();D.Rb(0,"div"),D.Rb(1,"button",17),D.Yb("click",(function(){return D.oc(e),D.cc().changePassword()})),D.zc(2," Change password "),D.Qb(),D.Qb()}}let H=(()=>{class e{constructor(e,t,r,s){this.formBuilder=e,this.location=t,this.store=r,this.route=s,this.subscriptions=new Q.a}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.userForm=this.formBuilder.group({email:new i.g("",[i.F.required,i.F.email]),firstName:new i.g("",[i.F.required]),lastName:new i.g("",[i.F.required]),phone:new i.g(""),restaurant:new i.g("",[i.F.required]),role:new i.g("",[i.F.required])}),this.subscriptions.add(this.store.select(q(this.route.snapshot.params.id)).subscribe(e=>{var t,r,s,a,o,c;e?this.isEdit=!0:(this.isEdit=!1,this.userForm.addControl("password",new i.g("",[i.F.required,i.F.minLength(6)])),this.userForm.addControl("passwordCheck",new i.g("",[i.F.required]))),this.user=e,this.userForm.controls.email.setValue(null===(t=this.user)||void 0===t?void 0:t.email),this.userForm.controls.firstName.setValue(null===(r=this.user)||void 0===r?void 0:r.firstName),this.userForm.controls.lastName.setValue(null===(s=this.user)||void 0===s?void 0:s.lastName),this.userForm.controls.phone.setValue(null===(a=this.user)||void 0===a?void 0:a.phone),this.userForm.controls.restaurant.setValue(null===(o=this.user)||void 0===o?void 0:o.restaurantId),this.userForm.controls.role.setValue(""+(null===(c=this.user)||void 0===c?void 0:c.userRole))})),this.subscriptions.add(this.store.select(O.c).subscribe(e=>{this.restaurantsComboItems=e})),this.subscriptions.add(this.store.select(w.d).subscribe(e=>{this.userRoles=e.map(e=>({value:e.userRole,text:e.userRole.toString().toLowerCase()}))}))}navigateBack(){this.location.back()}onSubmit(){var e,t;if(!this.userForm.invalid)if(this.isEdit){const t={id:null===(e=this.user)||void 0===e?void 0:e.id,email:this.userForm.controls.email.value,firstName:this.userForm.controls.firstName.value,lastName:this.userForm.controls.lastName.value,phone:this.userForm.controls.phone.value,restaurantId:this.userForm.controls.restaurant.value,userRoleId:this.userForm.controls.role.value};this.store.dispatch(Object(F.h)({user:t}))}else{if(this.userForm.controls.password.value!==this.userForm.controls.passwordCheck.value)return void this.userForm.controls.passwordCheck.setErrors({differentPassword:!0});const e={id:null===(t=this.user)||void 0===t?void 0:t.id,email:this.userForm.controls.email.value,firstName:this.userForm.controls.firstName.value,lastName:this.userForm.controls.lastName.value,phone:this.userForm.controls.phone.value,password:this.userForm.controls.password.value,restaurantId:this.userForm.controls.restaurant.value,userRoleId:this.userForm.controls.role.value};this.store.dispatch(Object(F.e)({user:e}))}}changePassword(){}}return e.\u0275fac=function(t){return new(t||e)(D.Mb(i.f),D.Mb(s.n),D.Mb(g.h),D.Mb(f.a))},e.\u0275cmp=D.Gb({type:e,selectors:[["app-edit-user"]],decls:46,vars:13,consts:[[1,"edit-form-container"],[1,"header"],[4,"ngIf"],[3,"formGroup"],[1,"input-full-width"],["type","email","matInput","","placeholder","Email","formControlName","email"],["type","text","matInput","","placeholder","First name","formControlName","firstName"],["color","primary-text",1,"input-full-width"],["type","text","matInput","","placeholder","Surname","formControlName","lastName"],["type","tel","matInput","","placeholder","Phone","formControlName","phone"],["class","input-full-width","color","primary-text",4,"ngIf"],["placeholder","Select user restaurant","formControlName","restaurant"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select user role","formControlName","role"],[1,"actions"],["mat-button","",1,"back-button",3,"click"],["mat-button","",1,"primary-button",3,"click"],["type","password","matInput","","placeholder","Password","formControlName","password"],["type","password","matInput","","placeholder","Verify password","formControlName","passwordCheck"],[3,"value"]],template:function(e,t){1&e&&(D.Rb(0,"div",0),D.Rb(1,"div",1),D.yc(2,S,2,0,"span",2),D.yc(3,E,2,0,"span",2),D.Qb(),D.Rb(4,"form",3),D.Rb(5,"mat-form-field",4),D.Rb(6,"mat-label"),D.zc(7,"Email"),D.Qb(),D.Nb(8,"input",5),D.yc(9,$,4,0,"mat-error",2),D.Qb(),D.Rb(10,"mat-form-field",4),D.Rb(11,"mat-label"),D.zc(12,"First name"),D.Qb(),D.Nb(13,"input",6),D.yc(14,G,4,0,"mat-error",2),D.Qb(),D.Rb(15,"mat-form-field",7),D.Rb(16,"mat-label"),D.zc(17,"Surname"),D.Qb(),D.Nb(18,"input",8),D.yc(19,V,4,0,"mat-error",2),D.Qb(),D.Rb(20,"mat-form-field",7),D.Rb(21,"mat-label"),D.zc(22,"Phone"),D.Qb(),D.Nb(23,"input",9),D.Qb(),D.yc(24,P,5,1,"mat-form-field",10),D.yc(25,L,6,2,"mat-form-field",10),D.Rb(26,"mat-form-field",4),D.Rb(27,"mat-select",11),D.Rb(28,"mat-option",12),D.zc(29,"Choose restaurant"),D.Qb(),D.yc(30,_,2,2,"mat-option",13),D.Qb(),D.yc(31,J,4,0,"mat-error",2),D.Qb(),D.Rb(32,"mat-form-field",4),D.Rb(33,"mat-select",14),D.Rb(34,"mat-option",12),D.zc(35,"Choose role"),D.Qb(),D.yc(36,K,2,2,"mat-option",13),D.Qb(),D.yc(37,W,4,0,"mat-error",2),D.Qb(),D.yc(38,X,3,0,"div",2),D.Rb(39,"div",15),D.Rb(40,"button",16),D.Yb("click",(function(){return t.navigateBack()})),D.Rb(41,"mat-icon"),D.zc(42,"arrow_back"),D.Qb(),D.zc(43," Back "),D.Qb(),D.Rb(44,"button",17),D.Yb("click",(function(){return t.onSubmit()})),D.zc(45," Save "),D.Qb(),D.Qb(),D.Qb(),D.Qb()),2&e&&(D.Ab(2),D.ic("ngIf",!t.isEdit),D.Ab(1),D.ic("ngIf",t.isEdit),D.Ab(1),D.ic("formGroup",t.userForm),D.Ab(5),D.ic("ngIf",t.userForm.controls.email.hasError("required")),D.Ab(5),D.ic("ngIf",t.userForm.controls.firstName.hasError("required")),D.Ab(5),D.ic("ngIf",t.userForm.controls.lastName.hasError("required")),D.Ab(5),D.ic("ngIf",!t.isEdit),D.Ab(1),D.ic("ngIf",!t.isEdit),D.Ab(5),D.ic("ngForOf",t.restaurantsComboItems),D.Ab(1),D.ic("ngIf",t.userForm.controls.restaurant.hasError("required")),D.Ab(5),D.ic("ngForOf",t.userRoles),D.Ab(1),D.ic("ngIf",t.userForm.controls.role.hasError("required")),D.Ab(1),D.ic("ngIf",t.isEdit))},directives:[s.t,i.H,i.s,i.j,M.c,M.g,l.a,i.c,i.r,i.i,m.a,n.f,s.s,a.b,b.a,M.b],styles:[""]}),e})();var T=r("LRne"),Z=r("eIep"),ee=r("lJxs"),te=r("JIr8"),re=r("AytR"),se=r("dlWp"),ie=r("GXKv"),ae=r("tk/3"),oe=r("4xmj");let ce=(()=>{class e{constructor(e,t,r){this.actions$=e,this.http=t,this.snackbarService=r,this.loadRestaurantUsers$=Object(v.c)(()=>this.actions$.pipe(Object(v.d)(F.c),Object(Z.a)(e=>this.http.get(this.baseUrl+"GetListOfRestaurantUsers").pipe(Object(ee.a)(e=>Object(F.d)({users:e.data})),Object(te.a)(e=>Object(T.a)(Object(ie.a)({error:e.error.Message,msg:"Load restaurant users failed",action:"loadRestaurantUsers"}))))))),this.deleteUser$=Object(v.c)(()=>this.actions$.pipe(Object(v.d)(F.a),Object(Z.a)(e=>this.http.delete(`${this.baseUrl}DeleteUser?id=${e.id}`).pipe(Object(ee.a)(t=>(this.snackbarService.showMessage("Successfull delete","deleteUser",se.a.Success),e.successCallback(),Object(F.b)({id:e.id}))),Object(te.a)(e=>Object(T.a)(Object(ie.a)({error:e.error.Message,msg:"Delete failed",action:"deleteUser"}))))))),this.registerUser$=Object(v.c)(()=>this.actions$.pipe(Object(v.d)(F.e),Object(Z.a)(e=>this.http.post(this.baseUrl+"Register",e.user).pipe(Object(ee.a)(e=>(this.snackbarService.showMessage("User registered","registerUser",se.a.Success),Object(F.f)({user:e.data}))),Object(te.a)(e=>Object(T.a)(Object(ie.a)({error:e.error.Message,msg:"Registration failed",action:"registerUser"}))))))),this.updateUser$=Object(v.c)(()=>this.actions$.pipe(Object(v.d)(F.h),Object(Z.a)(e=>this.http.patch(this.baseUrl+"UpdateUser",e.user).pipe(Object(ee.a)(e=>(this.snackbarService.showMessage("User updated","updateUser",se.a.Success),Object(F.i)({user:e.data}))),Object(te.a)(e=>Object(T.a)(Object(ie.a)({error:e.error.Message,msg:"Update failed",action:"updateUser"}))))))),this.baseUrl=re.a.apiUrl+"/api/User/"}}return e.\u0275fac=function(t){return new(t||e)(D.Vb(v.a),D.Vb(ae.b),D.Vb(oe.a))},e.\u0275prov=D.Ib({token:e,factory:e.\u0275fac}),e})();var ne=r("hed6"),ue=r("hCxx"),be=r("Do2H");let le=(()=>{class e{constructor(e,t,r,s,i,a){this.router=e,this.route=t,this.location=r,this.dialog=s,this.baseService=i,this.store=a,this.subscriptions=new Q.a}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.subscriptions.add(this.store.select(q(this.route.snapshot.params.id)).subscribe(e=>{this.userDetail=e}))}navigateBack(){this.location.back()}deleteUser(){this.dialog.open(ue.a,{width:"300px",data:{message:"Delete user"},autoFocus:!1}).afterClosed().subscribe(e=>{void 0!==e&&!0===e&&this.store.dispatch(Object(F.a)({id:this.userDetail.id,successCallback:this.baseService.navigateBackWithTimeout}))})}editUser(){this.router.navigate(["/users/edit",this.userDetail.id])}}return e.\u0275fac=function(t){return new(t||e)(D.Mb(f.c),D.Mb(f.a),D.Mb(s.n),D.Mb(u.b),D.Mb(be.a),D.Mb(g.h))},e.\u0275cmp=D.Gb({type:e,selectors:[["app-user-detail"]],decls:18,vars:4,consts:[[1,"detail-header"],[1,"detail-image"],["matRipple","",3,"click"],["src","./assets/images/image_not_found2.jpg"],[1,"detail-description"],[1,"name"],[1,"description"],[1,"actions"],["mat-button","",1,"danger-button",3,"click"],["mat-button","",1,"primary-button",3,"click"]],template:function(e,t){1&e&&(D.Nb(0,"div",0),D.Rb(1,"div",1),D.Rb(2,"mat-icon",2),D.Yb("click",(function(){return t.navigateBack()})),D.zc(3,"keyboard_backspace"),D.Qb(),D.Nb(4,"img",3),D.Qb(),D.Rb(5,"div",4),D.Rb(6,"div",5),D.Rb(7,"span"),D.zc(8),D.Qb(),D.Qb(),D.Rb(9,"div",6),D.zc(10),D.Qb(),D.Rb(11,"div",6),D.zc(12),D.Qb(),D.Rb(13,"div",7),D.Rb(14,"button",8),D.Yb("click",(function(){return t.deleteUser()})),D.zc(15," Delete user "),D.Qb(),D.Rb(16,"button",9),D.Yb("click",(function(){return t.editUser()})),D.zc(17," Edit user "),D.Qb(),D.Qb(),D.Qb()),2&e&&(D.Ab(8),D.Cc("",null==t.userDetail?null:t.userDetail.firstName," ",null==t.userDetail?null:t.userDetail.lastName,""),D.Ab(2),D.Ac(null==t.userDetail?null:t.userDetail.email),D.Ab(2),D.Ac(null==t.userDetail?null:t.userDetail.phone))},directives:[b.a,n.h,a.b],styles:[".body-content{margin:0!important}.actions{display:flex;justify-content:space-around}"],encapsulation:2}),e})(),de=(()=>{class e{constructor(e,t){this.router=e,this.store=t}ngOnInit(){}openDetail(e){this.router.navigate(["/users/detail",e])}}return e.\u0275fac=function(t){return new(t||e)(D.Mb(f.c),D.Mb(g.h))},e.\u0275cmp=D.Gb({type:e,selectors:[["app-user-item"]],inputs:{user:"user"},decls:10,vars:2,consts:[["matRipple","",1,"list-item-content",3,"click"],[1,"list-item-header"],[1,"list-item-name"],[1,"offer-item-price"],[1,"price"]],template:function(e,t){1&e&&(D.Rb(0,"div",0),D.Yb("click",(function(){return t.openDetail(t.user.id)})),D.Rb(1,"div",1),D.Rb(2,"div"),D.Rb(3,"div"),D.Rb(4,"h3",2),D.zc(5),D.Qb(),D.Qb(),D.Rb(6,"div",3),D.Rb(7,"span",4),D.zc(8),D.Qb(),D.zc(9," \xa0 "),D.Qb(),D.Qb(),D.Qb(),D.Qb()),2&e&&(D.Ab(5),D.Bc(" ",t.user.name," "),D.Ab(3),D.Ac(t.user.email))},directives:[n.h],styles:[""]}),e})(),me=(()=>{class e{transform(e,t){return e.sort(t.nameAsc?(e,t)=>e.name<t.name?1:e.name>t.name?-1:0:(e,t)=>e.name>t.name?1:e.name<t.name?-1:0),e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=D.Lb({name:"userSort",type:e,pure:!0}),e})();function pe(e,t){1&e&&(D.Rb(0,"mat-icon"),D.zc(1,"arrow_drop_down"),D.Qb())}function he(e,t){1&e&&(D.Rb(0,"mat-icon"),D.zc(1,"arrow_drop_up"),D.Qb())}function fe(e,t){1&e&&D.Nb(0,"app-user-item",6),2&e&&D.ic("user",t.$implicit)}const ve=function(e){return{nameAsc:e}},ge=[{path:"",component:(()=>{class e{constructor(e,t){this.router=e,this.store=t,this.subscriptions=new Q.a,this.sortAscDesc=!0}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.store.dispatch(Object(F.c)()),this.store.dispatch(Object(F.g)({id:void 0})),this.subscriptions.add(this.store.select(C).subscribe(e=>{this.users=e}))}addNewUser(){this.router.navigate(["/users/add"])}sortUsers(){this.sortAscDesc=!this.sortAscDesc}}return e.\u0275fac=function(t){return new(t||e)(D.Mb(f.c),D.Mb(g.h))},e.\u0275cmp=D.Gb({type:e,selectors:[["app-user"]],decls:14,vars:8,consts:[[1,"restaurant-content"],[1,"header-container"],["matRipple","",1,"sort-item",3,"click"],[4,"ngIf"],["mat-button","",1,"base-button",3,"click"],[3,"user",4,"ngFor","ngForOf"],[3,"user"]],template:function(e,t){1&e&&(D.Rb(0,"div",0),D.Rb(1,"div",1),D.Rb(2,"div",2),D.Yb("click",(function(){return t.sortUsers()})),D.Rb(3,"span"),D.zc(4,"Name"),D.Qb(),D.zc(5," \xa0 "),D.yc(6,pe,2,0,"mat-icon",3),D.yc(7,he,2,0,"mat-icon",3),D.Qb(),D.Rb(8,"button",4),D.Yb("click",(function(){return t.addNewUser()})),D.zc(9," New \xa0"),D.Rb(10,"mat-icon"),D.zc(11,"add"),D.Qb(),D.Qb(),D.Qb(),D.yc(12,fe,1,1,"app-user-item",5),D.dc(13,"userSort"),D.Qb()),2&e&&(D.Ab(6),D.ic("ngIf",t.sortAscDesc),D.Ab(1),D.ic("ngIf",!t.sortAscDesc),D.Ab(5),D.ic("ngForOf",D.fc(13,3,t.users,D.kc(6,ve,t.sortAscDesc))))},directives:[n.h,s.t,a.b,b.a,s.s,de],pipes:[me],styles:[""]}),e})()},{path:"add",component:H,canActivate:[R.a],resolve:{result:ne.a},runGuardsAndResolvers:"always"},{path:"edit/:id",component:H,canActivate:[R.a],resolve:{result:ne.a},runGuardsAndResolvers:"always"},{path:"detail/:id",component:le,canActivate:[R.a],resolve:{result:ne.a},runGuardsAndResolvers:"always"}];let Re=(()=>{class e{}return e.\u0275mod=D.Kb({type:e}),e.\u0275inj=D.Jb({factory:function(t){return new(t||e)},providers:[ne.a],imports:[[g.j.forFeature("user",k),v.b.forFeature([ce]),f.g.forChild(ge),s.c,i.l,m.b,d.c,i.B,c.c,u.g,p.b,b.b,a.c,o.j,l.b,n.i,h.c]]}),e})()}}]);